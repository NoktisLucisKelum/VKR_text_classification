import torch
from transformers import T5ForConditionalGeneration, T5Tokenizer

MODEL_NAME = 'cointegrated/rut5-base-paraphraser'
model = T5ForConditionalGeneration.from_pretrained(MODEL_NAME)
tokenizer = T5Tokenizer.from_pretrained(MODEL_NAME)
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")


def paraphrase(text, beams=5, grams=4):
    x = tokenizer(text, return_tensors='pt', padding=True).to(model.device)
    max_size = int(x.input_ids.shape[1] * 1.5 + 10)
    out = model.generate(**x, encoder_no_repeat_ngram_size=grams, num_beams=beams, max_length=max_size)
    return tokenizer.decode(out[0], skip_special_tokens=True)


print("Оригинальный текст 1:")
print("Проблемы развития пассажирских портов России.Отмечается, что одной из форм взаимодействия государства и бизнеса выступает институт государственно-частного партнерства (ГЧП), который позволяет привлечь в экономику дополнительные ресурсы, перераспределить риски между государством и предпринимательским сектором, направить усилия предпринимателей на решение значимых для общества социально-экономических целей и задач. Так на основе ГЧП было осуществлено строительство нового пассажирского порта Санкт-Петербург в 2005-м году, что существенно повлияло на темпы социально-экономического развития города и региона. На основе имеющейся нормативно-правовой базы видится необходимость выявления точек взаимодействия государства и частного бизнеса относительно развития пассажирских портов как элемента обеспечения экономической безопасности страны. Необходимо проработать институциональные основы формирования развития собственного производства, возможностей применения ГЧП. Это позволит развить не только транспортный аспект, но и решить экономические и социально-культурные проблемы приморских территорий.")
print("Перефразированный текст 1:")
print(paraphrase(
    'Проблемы развития пассажирских портов России.Отмечается, что одной из форм взаимодействия государства и бизнеса выступает институт государственно-частного партнерства (ГЧП), который позволяет привлечь в экономику дополнительные ресурсы, перераспределить риски между государством и предпринимательским сектором, направить усилия предпринимателей на решение значимых для общества социально-экономических целей и задач. Так на основе ГЧП было осуществлено строительство нового пассажирского порта Санкт-Петербург в 2005-м году, что существенно повлияло на темпы социально-экономического развития города и региона. На основе имеющейся нормативно-правовой базы видится необходимость выявления точек взаимодействия государства и частного бизнеса относительно развития пассажирских портов как элемента обеспечения экономической безопасности страны. Необходимо проработать институциональные основы формирования развития собственного производства, возможностей применения ГЧП. Это позволит развить не только транспортный аспект, но и решить экономические и социально-культурные проблемы приморских территорий.'))
print("Оригинальный текст 2:")
print("Связь радиояркостных и диэлектрических свойств водных растворов солей в миллиметровой области спектра	Разработан новый подход к исследованию водных растворов солей на основе их изучения в миллиметровой области спектра. С помощью высокочувствительного радиометра на частоте 61.2__ГГц определены коэффициенты отражения и радиояркостные контрасты для растворов сульфатов щелочных металлов в широкой области концентраций. Установлено наличие разнознаковых изменений растворов по сравнению с водой. Дано теоретическое обоснование и количественное описание измеряемых эффектов на основе данных комплексной диэлектрической проницаемости растворов. Показано, что излучение отражает вклады как дипольных, так и ионных потерь, которые все еще остаются значимыми на рассматриваемых частотах; они могут даже определять наличие разнознаковых эффектов излучения")
print("Перефразированный текст 2:")
print(paraphrase("Cвязь радиояркостных и диэлектрических свойств водных растворов солей в миллиметровой области спектра	Разработан новый подход к исследованию водных растворов солей на основе их изучения в миллиметровой области спектра. С помощью высокочувствительного радиометра на частоте 61.2__ГГц определены коэффициенты отражения и радиояркостные контрасты для растворов сульфатов щелочных металлов в широкой области концентраций. Установлено наличие разнознаковых изменений растворов по сравнению с водой. Дано теоретическое обоснование и количественное описание измеряемых эффектов на основе данных комплексной диэлектрической проницаемости растворов. Показано, что излучение отражает вклады как дипольных, так и ионных потерь, которые все еще остаются значимыми на рассматриваемых частотах; они могут даже определять наличие разнознаковых эффектов излучения"))
print("__________________________________________________________________")
# print("Оригинальный текст 2:")
# print("Получение и оптимизация термоэлектрических свойств сплавов на основе Bi[2]Te[3] с помощью лишних частиц как исходных материалов, полученных в процессе резки кристаллических стержней, изготовленных методом зонной плавки	С помощью частиц, полученных резкой кристаллич. стержней, изготовленных методом зонной плавки, получены сплавы Bi[2]Te[3]. Изучены их термоэлектрич. свойства и показано, что большинство примесей, возникающих в процессе резки и окисления, таких как Sb[2]O[3], Bi[2]O[3] и Bi[2]Te[4]O[11], могут быть удалены восстановлением СО и вакуумным металлургич. процессом с эффективностью более 97%. Образец Bi[0,36]Sb[1,64]Te[3] показывает максим. фактор мощности 4,24 мВт/м~xK{2} при среднем значении 3,2 мВт/м~xK{2} в диапазоне 300_-470 К.	TQGS\TQIH")
# print("Перефразированный текст 2:")
# print(paraphrase("Получение и оптимизация термоэлектрических свойств сплавов на основе Bi[2]Te[3] с помощью лишних частиц как исходных материалов, полученных в процессе резки кристаллических стержней, изготовленных методом зонной плавки	С помощью частиц, полученных резкой кристаллич. стержней, изготовленных методом зонной плавки, получены сплавы Bi[2]Te[3]. Изучены их термоэлектрич. свойства и показано, что большинство примесей, возникающих в процессе резки и окисления, таких как Sb[2]O[3], Bi[2]O[3] и Bi[2]Te[4]O[11], могут быть удалены восстановлением СО и вакуумным металлургич. процессом с эффективностью более 97%. Образец Bi[0,36]Sb[1,64]Te[3] показывает максим. фактор мощности 4,24 мВт/м~xK{2} при среднем значении 3,2 мВт/м~xK{2} в диапазоне 300_-470 К.	TQGS\TQIH"))
# print("__________________________________________________________________")
print("Тестирование на инфинитиве")
print("Оригинальрный текст 1: ")
print("провести экспериментальный исследование jfisblaku_сжигание_vhsljdka jfisblaku_этилен_vhsljdka пористый jfisblaku_горелка_vhsljdka уложить последовательно алюминиевый шар диаметр 3мма 9мма цель jfisblaku_изучение_vhsljdka jfisblaku_воспламеняемости_vhsljdka температурный характеристик jfisblaku_скорость_vhsljdka jfisblaku_распространение_vhsljdka пламени jfisblaku_эмиссия_vhsljdka jfisblaku_загрязнять_vhsljdka jfisblaku_веществ_vhsljdka jfisblaku_горелка_vhsljdka управляться соотношение 03 07 установлено увеличение плотность укладка шаров ширина снижаться предел легковоспламеняемости jfisblaku_температура_vhsljdka jfisblaku_горение_vhsljdka увеличиваться соответствие jfisblaku_скорость_vhsljdka перемешать газовый потока показано jfisblaku_температура_vhsljdka jfisblaku_горение_vhsljdka повышается снижаться jfisblaku_эмиссия_vhsljdka углекислый газ jfisblaku_эффективность_vhsljdka диаметр шаров 3мма сравнение диаметр шар 9ммасжигание жидкий vocs пористый горелке jfisblaku_заполнить_vhsljdka jfisblaku_глинозёмный_vhsljdka jfisblaku_шариками_vhsljdka футляр jfisblaku_сжигание_vhsljdka jfisblaku_этилен_vhsljdka,воспламенение воспламеняемость горелки горелка пористые загрязнять вещества изучение пламя пористые, заполнить глинозёмный шариками сжигание сжигание газообразный топлива скорость распространения температура эмиссия этилен эффективность горение")
print("Перефразированный текст 1: ")
print(paraphrase("провести экспериментальный исследование jfisblaku_сжигание_vhsljdka jfisblaku_этилен_vhsljdka пористый jfisblaku_горелка_vhsljdka уложить последовательно алюминиевый шар диаметр 3мма 9мма цель jfisblaku_изучение_vhsljdka jfisblaku_воспламеняемости_vhsljdka температурный характеристик jfisblaku_скорость_vhsljdka jfisblaku_распространение_vhsljdka пламени jfisblaku_эмиссия_vhsljdka jfisblaku_загрязнять_vhsljdka jfisblaku_веществ_vhsljdka jfisblaku_горелка_vhsljdka управляться соотношение 03 07 установлено увеличение плотность укладка шаров ширина снижаться предел легковоспламеняемости jfisblaku_температура_vhsljdka jfisblaku_горение_vhsljdka увеличиваться соответствие jfisblaku_скорость_vhsljdka перемешать газовый потока показано jfisblaku_температура_vhsljdka jfisblaku_горение_vhsljdka повышается снижаться jfisblaku_эмиссия_vhsljdka углекислый газ jfisblaku_эффективность_vhsljdka диаметр шаров 3мма сравнение диаметр шар 9ммасжигание жидкий vocs пористый горелке jfisblaku_заполнить_vhsljdka jfisblaku_глинозёмный_vhsljdka jfisblaku_шариками_vhsljdka футляр jfisblaku_сжигание_vhsljdka jfisblaku_этилен_vhsljdka,воспламенение воспламеняемость горелки горелка пористые загрязнять вещества изучение пламя пористые, заполнить глинозёмный шариками сжигание сжигание газообразный топлива скорость распространения температура эмиссия этилен эффективность горение"))
print("Оригинальрный текст 2: ")
print("февраль 2018г тюменский аэропорт плеханово состояться первый коммерческий полёт новый вертолёт ми171а2 компания ютэйр jfisblaku_вертолётный_vhsljdka услуги машина произвести уланудэнский авиационный завод холдинг вертолёт россии передать эксплуатант май 2018г рамка выставка helirussia 2018 сразу это специалист холдинг ютэйр jfisblaku_вертолётный_vhsljdka услуги начать реализовывать комплекс мероприятие освоение эксплуатация новый вертолета экипаж jfisblaku_авиакомпания_vhsljdka пройти подготовка специально разработать утвердить программам специалист ютэйринжиниринг освоить полный комплекс технический обслуживание глубоко модернизированный вертолета итог провести работа jfisblaku_авиакомпания_vhsljdka ютэйр jfisblaku_вертолётный_vhsljdka услуги получить соответствовать разрешение федеральный агентство воздушный транспорт коммерческий эксплуатация ми171а2 стартовый заказчик рейс новый машина стать тюменский компания рнуватнефтегаз входящий группа компания роснефть ми171а2 перевозить сотрудник тюмень тобольск работа нефтяной месторождение уватский группа западный сибирьначаться эксплуатация ми171а2 ютэйр,авиакомпании вертолетный парк,")
print("Перефразированный текст 2: ")
print(paraphrase("февраль 2018г тюменский аэропорт плеханово состояться первый коммерческий полёт новый вертолёт ми171а2 компания ютэйр jfisblaku_вертолётный_vhsljdka услуги машина произвести уланудэнский авиационный завод холдинг вертолёт россии передать эксплуатант май 2018г рамка выставка helirussia 2018 сразу это специалист холдинг ютэйр jfisblaku_вертолётный_vhsljdka услуги начать реализовывать комплекс мероприятие освоение эксплуатация новый вертолета экипаж jfisblaku_авиакомпания_vhsljdka пройти подготовка специально разработать утвердить программам специалист ютэйринжиниринг освоить полный комплекс технический обслуживание глубоко модернизированный вертолета итог провести работа jfisblaku_авиакомпания_vhsljdka ютэйр jfisblaku_вертолётный_vhsljdka услуги получить соответствовать разрешение федеральный агентство воздушный транспорт коммерческий эксплуатация ми171а2 стартовый заказчик рейс новый машина стать тюменский компания рнуватнефтегаз входящий группа компания роснефть ми171а2 перевозить сотрудник тюмень тобольск работа нефтяной месторождение уватский группа западный сибирьначаться эксплуатация ми171а2 ютэйр,авиакомпании вертолетный парк,"))
